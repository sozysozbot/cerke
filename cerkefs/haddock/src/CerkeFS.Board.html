<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">CerkeFS</span><span class="hs-operator">.</span><span class="hs-identifier">Board</span><span>
</span><a name="line-2"></a><span class="hs-special">(</span><a href="CerkeFS.Board.html#Col"><span class="hs-identifier hs-type">Col</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-3"></a><span class="hs-special">,</span><a href="CerkeFS.Board.html#Row"><span class="hs-identifier hs-type">Row</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-4"></a><span class="hs-special">,</span><a href="CerkeFS.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-5"></a><span class="hs-special">,</span><a href="CerkeFS.Board.html#Board1"><span class="hs-identifier hs-type">Board1</span></a><span>
</span><a name="line-6"></a><span class="hs-comment">-- ,Vec(..)</span><span>
</span><a name="line-7"></a><span class="hs-special">,</span><a href="CerkeFS.Board.html#putPiece"><span class="hs-identifier hs-var">putPiece</span></a><span>
</span><a name="line-8"></a><span class="hs-special">,</span><a href="CerkeFS.Board.html#removePiece"><span class="hs-identifier hs-var">removePiece</span></a><span>
</span><a name="line-9"></a><span class="hs-comment">--,movePiece</span><span>
</span><a name="line-10"></a><span class="hs-special">,</span><a href="CerkeFS.Board.html#movePieceFromTo"><span class="hs-identifier hs-var">movePieceFromTo</span></a><span>
</span><a name="line-11"></a><span class="hs-special">,</span><a href="CerkeFS.Board.html#movePieceFromToProf"><span class="hs-identifier hs-var">movePieceFromToProf</span></a><span>
</span><a name="line-12"></a><span class="hs-special">,</span><a href="CerkeFS.Board.html#Error"><span class="hs-identifier hs-type">Error</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-13"></a><span class="hs-special">,</span><a href="CerkeFS.Board.html#M"><span class="hs-identifier hs-type">M</span></a><span>
</span><a name="line-14"></a><span class="hs-special">,</span><a href="CerkeFS.Board.html#toEither"><span class="hs-identifier hs-var">toEither</span></a><span>
</span><a name="line-15"></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span> </span><a href="CerkeFS.Piece3.html"><span class="hs-identifier">CerkeFS</span><span class="hs-operator">.</span><span class="hs-identifier">Piece3</span></a><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Map</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">M</span><span>
</span><a name="line-18"></a><span>
</span><a name="line-19"></a><span class="hs-keyword">data</span><span> </span><a name="Col"><a href="CerkeFS.Board.html#Col"><span class="hs-identifier">Col</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="CK"><a href="CerkeFS.Board.html#CK"><span class="hs-identifier">CK</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="CL"><a href="CerkeFS.Board.html#CL"><span class="hs-identifier">CL</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="CN"><a href="CerkeFS.Board.html#CN"><span class="hs-identifier">CN</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="CT"><a href="CerkeFS.Board.html#CT"><span class="hs-identifier">CT</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="CZ"><a href="CerkeFS.Board.html#CZ"><span class="hs-identifier">CZ</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="CX"><a href="CerkeFS.Board.html#CX"><span class="hs-identifier">CX</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="CC"><a href="CerkeFS.Board.html#CC"><span class="hs-identifier">CC</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="CM"><a href="CerkeFS.Board.html#CM"><span class="hs-identifier">CM</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="CP"><a href="CerkeFS.Board.html#CP"><span class="hs-identifier">CP</span></a></a><span> </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">)</span><span>
</span><a name="line-20"></a><span class="hs-keyword">data</span><span> </span><a name="Row"><a href="CerkeFS.Board.html#Row"><span class="hs-identifier">Row</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="RA"><a href="CerkeFS.Board.html#RA"><span class="hs-identifier">RA</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="RE"><a href="CerkeFS.Board.html#RE"><span class="hs-identifier">RE</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="RI"><a href="CerkeFS.Board.html#RI"><span class="hs-identifier">RI</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="RU"><a href="CerkeFS.Board.html#RU"><span class="hs-identifier">RU</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="RO"><a href="CerkeFS.Board.html#RO"><span class="hs-identifier">RO</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="RY"><a href="CerkeFS.Board.html#RY"><span class="hs-identifier">RY</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="RAI"><a href="CerkeFS.Board.html#RAI"><span class="hs-identifier">RAI</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="RAU"><a href="CerkeFS.Board.html#RAU"><span class="hs-identifier">RAU</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="RIA"><a href="CerkeFS.Board.html#RIA"><span class="hs-identifier">RIA</span></a></a><span> </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">)</span><span>
</span><a name="line-21"></a><span class="hs-keyword">data</span><span> </span><a name="Square"><a href="CerkeFS.Board.html#Square"><span class="hs-identifier">Square</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Square"><a href="CerkeFS.Board.html#Square"><span class="hs-identifier">Square</span></a></a><span class="hs-special">{</span><a name="row"><a href="CerkeFS.Board.html#row"><span class="hs-identifier">row</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="CerkeFS.Board.html#Row"><span class="hs-identifier hs-type">Row</span></a><span class="hs-special">,</span><span> </span><a name="col"><a href="CerkeFS.Board.html#col"><span class="hs-identifier">col</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="CerkeFS.Board.html#Col"><span class="hs-identifier hs-type">Col</span></a><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="CerkeFS.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-24"></a><span> </span><a name="local-8214565720323790232"><span class="hs-identifier">show</span></a><span> </span><a href="CerkeFS.Board.html#Square"><span class="hs-identifier hs-var">Square</span></a><span class="hs-special">{</span><span class="hs-identifier">col</span><span class="hs-glyph">=</span><a name="local-6989586621679029852"><a href="#local-6989586621679029852"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><span class="hs-identifier">row</span><span class="hs-glyph">=</span><a name="local-6989586621679029853"><a href="#local-6989586621679029853"><span class="hs-identifier">r</span></a></a><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;sq&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">tail</span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679029852"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">tail</span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679029853"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-keyword">type</span><span> </span><a name="Board1"><a href="CerkeFS.Board.html#Board1"><span class="hs-identifier">Board1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">M</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Map</span><span> </span><a href="CerkeFS.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span> </span><a href="CerkeFS.Internal.Piece2.html#Piece"><span class="hs-identifier hs-type">Piece</span></a><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span class="hs-keyword">type</span><span> </span><a name="M"><a href="CerkeFS.Board.html#M"><span class="hs-identifier">M</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="CerkeFS.Board.html#Error"><span class="hs-identifier hs-type">Error</span></a><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span class="hs-keyword">data</span><span> </span><a name="Vec"><a href="CerkeFS.Board.html#Vec"><span class="hs-identifier">Vec</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Vec"><a href="CerkeFS.Board.html#Vec"><span class="hs-identifier">Vec</span></a></a><span class="hs-special">{</span><a name="dx"><a href="CerkeFS.Board.html#dx"><span class="hs-identifier">dx</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><a name="dy"><a href="CerkeFS.Board.html#dy"><span class="hs-identifier">dy</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">}</span><span>
</span><a name="line-31"></a><span>
</span><a name="line-32"></a><span class="hs-identifier">add</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CerkeFS.Board.html#Vec"><span class="hs-identifier hs-type">Vec</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="CerkeFS.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span>
</span><a name="line-33"></a><a name="add"><a href="CerkeFS.Board.html#add"><span class="hs-identifier">add</span></a></a><span> </span><span class="hs-special">(</span><a href="CerkeFS.Board.html#Vec"><span class="hs-identifier hs-var">Vec</span></a><span> </span><a name="local-6989586621679029858"><a href="#local-6989586621679029858"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679029859"><a href="#local-6989586621679029859"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><a href="CerkeFS.Board.html#Square"><span class="hs-identifier hs-var">Square</span></a><span class="hs-special">{</span><span class="hs-identifier">col</span><span class="hs-glyph">=</span><a name="local-6989586621679029860"><a href="#local-6989586621679029860"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><span class="hs-identifier">row</span><span class="hs-glyph">=</span><a name="local-6989586621679029861"><a href="#local-6989586621679029861"><span class="hs-identifier">r</span></a></a><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-34"></a><span> </span><a name="local-6989586621679029862"><a href="#local-6989586621679029862"><span class="hs-identifier">new_c</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CerkeFS.Board.html#add%27"><span class="hs-identifier hs-var">add'</span></a><span> </span><a href="#local-6989586621679029858"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679029860"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-35"></a><span> </span><a name="local-6989586621679029863"><a href="#local-6989586621679029863"><span class="hs-identifier">new_r</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CerkeFS.Board.html#add%27"><span class="hs-identifier hs-var">add'</span></a><span> </span><a href="#local-6989586621679029859"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679029861"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-36"></a><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="CerkeFS.Board.html#Square"><span class="hs-identifier hs-var">Square</span></a><span class="hs-special">{</span><span class="hs-identifier">col</span><span class="hs-glyph">=</span><a href="#local-6989586621679029862"><span class="hs-identifier hs-var">new_c</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">row</span><span class="hs-glyph">=</span><a href="#local-6989586621679029863"><span class="hs-identifier hs-var">new_r</span></a><span class="hs-special">}</span><span>
</span><a name="line-37"></a><span>
</span><a name="line-38"></a><span class="hs-identifier">add'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Enum</span><span> </span><a href="#local-6989586621679029857"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679029857"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679029857"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-39"></a><a name="add%27"><a href="CerkeFS.Board.html#add%27"><span class="hs-identifier">add'</span></a></a><span> </span><a name="local-6989586621679029864"><a href="#local-6989586621679029864"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679029865"><a href="#local-6989586621679029865"><span class="hs-identifier">c</span></a></a><span>
</span><a name="line-40"></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679029864"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679029866"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span>
</span><a name="line-41"></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679029864"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679029866"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">8</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span>
</span><a name="line-42"></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">toEnum</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679029864"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679029866"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-43"></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679029866"><a href="#local-6989586621679029866"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromEnum</span><span> </span><a href="#local-6989586621679029865"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-44"></a><span>
</span><a name="line-45"></a><span>
</span><a name="line-46"></a><span class="hs-identifier">toEither</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679029855"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679029856"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="#local-6989586621679029855"><span class="hs-identifier hs-type">c</span></a><span> </span><a href="#local-6989586621679029856"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-47"></a><a name="toEither"><a href="CerkeFS.Board.html#toEither"><span class="hs-identifier">toEither</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">maybe</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">Right</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Left</span><span>
</span><a name="line-48"></a><span>
</span><a name="line-49"></a><span class="hs-keyword">data</span><span> </span><a name="Error"><a href="CerkeFS.Board.html#Error"><span class="hs-identifier">Error</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="AlreadyOccupied"><a href="CerkeFS.Board.html#AlreadyOccupied"><span class="hs-identifier">AlreadyOccupied</span></a></a><span> </span><a href="CerkeFS.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="EmptySquare"><a href="CerkeFS.Board.html#EmptySquare"><span class="hs-identifier">EmptySquare</span></a></a><span> </span><a href="CerkeFS.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="OutOfBoard"><a href="CerkeFS.Board.html#OutOfBoard"><span class="hs-identifier">OutOfBoard</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="TamCapture"><a href="CerkeFS.Board.html#TamCapture"><span class="hs-identifier">TamCapture</span></a></a><span> </span><span>
</span><a name="line-50"></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="NoCorrespondingPieceInHand"><a href="CerkeFS.Board.html#NoCorrespondingPieceInHand"><span class="hs-identifier">NoCorrespondingPieceInHand</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="MovingOpponentPiece"><a href="CerkeFS.Board.html#MovingOpponentPiece"><span class="hs-identifier">MovingOpponentPiece</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="FriendlyFire"><a href="CerkeFS.Board.html#FriendlyFire"><span class="hs-identifier">FriendlyFire</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="AmbiguousColor"><a href="CerkeFS.Board.html#AmbiguousColor"><span class="hs-identifier">AmbiguousColor</span></a></a><span> </span><span>
</span><a name="line-51"></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="WrongProfessionSpecified"><a href="CerkeFS.Board.html#WrongProfessionSpecified"><span class="hs-identifier">WrongProfessionSpecified</span></a></a><span> </span><span class="hs-special">{</span><a name="expected"><a href="CerkeFS.Board.html#expected"><span class="hs-identifier">expected</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="CerkeFS.Internal.Piece2.html#Profession"><span class="hs-identifier hs-type">Profession</span></a><span class="hs-special">,</span><span> </span><a name="specified"><a href="CerkeFS.Board.html#specified"><span class="hs-identifier">specified</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="CerkeFS.Internal.Piece2.html#Profession"><span class="hs-identifier hs-type">Profession</span></a><span class="hs-special">}</span><span>
</span><a name="line-52"></a><span> </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-comment">{-
********************************************
* Primitive operations on the board 
********************************************
-}</span><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span class="hs-identifier">isOccupiedFor</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CerkeFS.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Board.html#Board1"><span class="hs-identifier hs-type">Board1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-61"></a><a name="isOccupiedFor"><a href="CerkeFS.Board.html#isOccupiedFor"><span class="hs-identifier">isOccupiedFor</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">member</span><span>
</span><a name="line-62"></a><span>
</span><a name="line-63"></a><span class="hs-comment">-- put a piece on a square. fails if already occupied.</span><span>
</span><a name="line-64"></a><span class="hs-identifier">putPiece</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CerkeFS.Internal.Piece2.html#Piece"><span class="hs-identifier hs-type">Piece</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Board.html#Board1"><span class="hs-identifier hs-type">Board1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Board.html#M"><span class="hs-identifier hs-type">M</span></a><span> </span><a href="CerkeFS.Board.html#Board1"><span class="hs-identifier hs-type">Board1</span></a><span>
</span><a name="line-65"></a><a name="putPiece"><a href="CerkeFS.Board.html#putPiece"><span class="hs-identifier">putPiece</span></a></a><span> </span><a name="local-6989586621679029892"><a href="#local-6989586621679029892"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679029893"><a href="#local-6989586621679029893"><span class="hs-identifier">sq</span></a></a><span> </span><a name="local-6989586621679029894"><a href="#local-6989586621679029894"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679029893"><span class="hs-identifier hs-var">sq</span></a><span> </span><span class="hs-special">`</span><a href="CerkeFS.Board.html#isOccupiedFor"><span class="hs-identifier hs-var">isOccupiedFor</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679029894"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><a href="CerkeFS.Board.html#AlreadyOccupied"><span class="hs-identifier hs-var">AlreadyOccupied</span></a><span> </span><a href="#local-6989586621679029893"><span class="hs-identifier hs-var">sq</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Right</span><span class="hs-special">(</span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">insert</span><span> </span><a href="#local-6989586621679029893"><span class="hs-identifier hs-var">sq</span></a><span> </span><a href="#local-6989586621679029892"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679029894"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span class="hs-comment">-- remove a piece. fails if empty.</span><span>
</span><a name="line-68"></a><span class="hs-identifier">removePiece</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CerkeFS.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Board.html#Board1"><span class="hs-identifier hs-type">Board1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Board.html#M"><span class="hs-identifier hs-type">M</span></a><span> </span><span class="hs-special">(</span><a href="CerkeFS.Internal.Piece2.html#Piece"><span class="hs-identifier hs-type">Piece</span></a><span class="hs-special">,</span><span> </span><a href="CerkeFS.Board.html#Board1"><span class="hs-identifier hs-type">Board1</span></a><span class="hs-special">)</span><span>
</span><a name="line-69"></a><a name="removePiece"><a href="CerkeFS.Board.html#removePiece"><span class="hs-identifier">removePiece</span></a></a><span> </span><a name="local-6989586621679029895"><a href="#local-6989586621679029895"><span class="hs-identifier">sq</span></a></a><span> </span><a name="local-6989586621679029896"><a href="#local-6989586621679029896"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CerkeFS.Board.html#toEither"><span class="hs-identifier hs-var">toEither</span></a><span> </span><span class="hs-special">(</span><a href="CerkeFS.Board.html#EmptySquare"><span class="hs-identifier hs-var">EmptySquare</span></a><span> </span><a href="#local-6989586621679029895"><span class="hs-identifier hs-var">sq</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-70"></a><span> </span><a name="local-6989586621679029897"><a href="#local-6989586621679029897"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679029895"><span class="hs-identifier hs-var">sq</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">lookup</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679029896"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-71"></a><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679029897"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">delete</span><span> </span><a href="#local-6989586621679029895"><span class="hs-identifier hs-var">sq</span></a><span> </span><a href="#local-6989586621679029896"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><span class="hs-comment">-- move a piece on a square according to the vector. fails if:</span><span>
</span><a name="line-74"></a><span class="hs-comment">--  the piece goes out of the board</span><span>
</span><a name="line-75"></a><span class="hs-comment">--  the original square is empty</span><span>
</span><a name="line-76"></a><span class="hs-comment">--  the resulting square is already occupied</span><span>
</span><a name="line-77"></a><span class="hs-identifier">movePiece</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CerkeFS.Board.html#Vec"><span class="hs-identifier hs-type">Vec</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Board.html#Board1"><span class="hs-identifier hs-type">Board1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Board.html#M"><span class="hs-identifier hs-type">M</span></a><span> </span><a href="CerkeFS.Board.html#Board1"><span class="hs-identifier hs-type">Board1</span></a><span>
</span><a name="line-78"></a><a name="movePiece"><a href="CerkeFS.Board.html#movePiece"><span class="hs-identifier">movePiece</span></a></a><span> </span><a name="local-6989586621679029898"><a href="#local-6989586621679029898"><span class="hs-identifier">vec</span></a></a><span> </span><a name="local-6989586621679029899"><a href="#local-6989586621679029899"><span class="hs-identifier">sq</span></a></a><span> </span><a name="local-6989586621679029900"><a href="#local-6989586621679029900"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-79"></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679029901"><a href="#local-6989586621679029901"><span class="hs-identifier">p</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679029902"><a href="#local-6989586621679029902"><span class="hs-identifier">new_b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CerkeFS.Board.html#removePiece"><span class="hs-identifier hs-var">removePiece</span></a><span> </span><a href="#local-6989586621679029899"><span class="hs-identifier hs-var">sq</span></a><span> </span><a href="#local-6989586621679029900"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-80"></a><span> </span><a name="local-6989586621679029903"><a href="#local-6989586621679029903"><span class="hs-identifier">new_sq</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CerkeFS.Board.html#toEither"><span class="hs-identifier hs-var">toEither</span></a><span> </span><a href="CerkeFS.Board.html#OutOfBoard"><span class="hs-identifier hs-var">OutOfBoard</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="CerkeFS.Board.html#add"><span class="hs-identifier hs-var">add</span></a><span> </span><a href="#local-6989586621679029898"><span class="hs-identifier hs-var">vec</span></a><span> </span><a href="#local-6989586621679029899"><span class="hs-identifier hs-var">sq</span></a><span>
</span><a name="line-81"></a><span> </span><a href="CerkeFS.Board.html#putPiece"><span class="hs-identifier hs-var">putPiece</span></a><span> </span><a href="#local-6989586621679029901"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679029903"><span class="hs-identifier hs-var">new_sq</span></a><span> </span><a href="#local-6989586621679029902"><span class="hs-identifier hs-var">new_b</span></a><span>
</span><a name="line-82"></a><span>
</span><a name="line-83"></a><span class="hs-identifier">movePieceFromToFoo</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="CerkeFS.Internal.Piece2.html#Piece"><span class="hs-identifier hs-type">Piece</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679029854"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-84"></a><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Board.html#Board1"><span class="hs-identifier hs-type">Board1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="CerkeFS.Board.html#Error"><span class="hs-identifier hs-type">Error</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679029854"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="CerkeFS.Board.html#Board1"><span class="hs-identifier hs-type">Board1</span></a><span class="hs-special">)</span><span>
</span><a name="line-85"></a><a name="movePieceFromToFoo"><a href="CerkeFS.Board.html#movePieceFromToFoo"><span class="hs-identifier">movePieceFromToFoo</span></a></a><span> </span><a name="local-6989586621679029904"><a href="#local-6989586621679029904"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679029905"><a href="#local-6989586621679029905"><span class="hs-identifier">from</span></a></a><span> </span><a name="local-6989586621679029906"><a href="#local-6989586621679029906"><span class="hs-identifier">to</span></a></a><span> </span><a name="local-6989586621679029907"><a href="#local-6989586621679029907"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-86"></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679029908"><a href="#local-6989586621679029908"><span class="hs-identifier">p</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679029909"><a href="#local-6989586621679029909"><span class="hs-identifier">new_b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CerkeFS.Board.html#removePiece"><span class="hs-identifier hs-var">removePiece</span></a><span> </span><a href="#local-6989586621679029905"><span class="hs-identifier hs-var">from</span></a><span> </span><a href="#local-6989586621679029907"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-87"></a><span> </span><a name="local-6989586621679029910"><a href="#local-6989586621679029910"><span class="hs-identifier">newerBoard</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CerkeFS.Board.html#putPiece"><span class="hs-identifier hs-var">putPiece</span></a><span> </span><a href="#local-6989586621679029908"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679029906"><span class="hs-identifier hs-var">to</span></a><span> </span><a href="#local-6989586621679029909"><span class="hs-identifier hs-var">new_b</span></a><span>
</span><a name="line-88"></a><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679029904"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679029908"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679029910"><span class="hs-identifier hs-var">newerBoard</span></a><span class="hs-special">)</span><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span class="hs-identifier">movePieceFromTo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CerkeFS.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Board.html#Board1"><span class="hs-identifier hs-type">Board1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Board.html#M"><span class="hs-identifier hs-type">M</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="CerkeFS.Internal.Piece2.html#Side"><span class="hs-identifier hs-type">Side</span></a><span class="hs-special">,</span><span> </span><a href="CerkeFS.Board.html#Board1"><span class="hs-identifier hs-type">Board1</span></a><span class="hs-special">)</span><span>
</span><a name="line-91"></a><a name="movePieceFromTo"><a href="CerkeFS.Board.html#movePieceFromTo"><span class="hs-identifier">movePieceFromTo</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CerkeFS.Board.html#movePieceFromToFoo"><span class="hs-identifier hs-var">movePieceFromToFoo</span></a><span> </span><a href="CerkeFS.Internal.Piece2.html#getSide"><span class="hs-identifier hs-var">getSide</span></a><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span class="hs-identifier">movePieceFromToProf</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CerkeFS.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Board.html#Board1"><span class="hs-identifier hs-type">Board1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Board.html#M"><span class="hs-identifier hs-type">M</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="CerkeFS.Internal.Piece2.html#PhantomPiece"><span class="hs-identifier hs-type">PhantomPiece</span></a><span class="hs-special">,</span><span> </span><a href="CerkeFS.Board.html#Board1"><span class="hs-identifier hs-type">Board1</span></a><span class="hs-special">)</span><span>
</span><a name="line-94"></a><a name="movePieceFromToProf"><a href="CerkeFS.Board.html#movePieceFromToProf"><span class="hs-identifier">movePieceFromToProf</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CerkeFS.Board.html#movePieceFromToFoo"><span class="hs-identifier hs-var">movePieceFromToFoo</span></a><span> </span><a href="CerkeFS.Internal.Piece2.html#toPhantom"><span class="hs-identifier hs-var">toPhantom</span></a><span>
</span><a name="line-95"></a></pre></body></html>