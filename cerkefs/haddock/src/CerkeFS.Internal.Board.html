<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">CerkeFS</span><span class="hs-operator">.</span><span class="hs-identifier">Internal</span><span class="hs-operator">.</span><span class="hs-identifier">Board</span><span>
</span><a name="line-2"></a><span class="hs-special">(</span><a href="CerkeFS.Internal.Board.html#Col"><span class="hs-identifier hs-type">Col</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-3"></a><span class="hs-special">,</span><a href="CerkeFS.Internal.Board.html#Row"><span class="hs-identifier hs-type">Row</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-4"></a><span class="hs-special">,</span><a href="CerkeFS.Internal.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-5"></a><span class="hs-special">,</span><a href="CerkeFS.Internal.Board_Internal.html#Board1"><span class="hs-identifier hs-type">Board1</span></a><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-6"></a><span class="hs-special">,</span><a href="CerkeFS.Internal.Board.html#Vec"><span class="hs-identifier hs-type">Vec</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-7"></a><span class="hs-special">,</span><a href="CerkeFS.Internal.Board.html#putPiece"><span class="hs-identifier hs-var">putPiece</span></a><span>
</span><a name="line-8"></a><span class="hs-special">,</span><a href="CerkeFS.Internal.Board.html#removePiece"><span class="hs-identifier hs-var">removePiece</span></a><span>
</span><a name="line-9"></a><span class="hs-comment">--,movePiece</span><span>
</span><a name="line-10"></a><span class="hs-comment">--,movePieceFromTo</span><span>
</span><a name="line-11"></a><span class="hs-special">,</span><a href="CerkeFS.Internal.Board.html#movePieceFromToFull"><span class="hs-identifier hs-var">movePieceFromToFull</span></a><span>
</span><a name="line-12"></a><span class="hs-special">,</span><a href="CerkeFS.Internal.Board.html#Error"><span class="hs-identifier hs-type">Error</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-13"></a><span class="hs-special">,</span><a href="CerkeFS.Internal.Board.html#add"><span class="hs-identifier hs-var">add</span></a><span class="hs-special">,</span><a href="CerkeFS.Internal.Board.html#add_"><span class="hs-identifier hs-var">add_</span></a><span class="hs-special">,</span><a href="CerkeFS.Internal.Board.html#minus"><span class="hs-identifier hs-var">minus</span></a><span>
</span><a name="line-14"></a><span class="hs-special">,</span><a href="CerkeFS.Internal.Board.html#getNeighborsAndSelf"><span class="hs-identifier hs-var">getNeighborsAndSelf</span></a><span>
</span><a name="line-15"></a><span class="hs-special">,</span><a href="CerkeFS.Internal.Board.html#getNeighbors"><span class="hs-identifier hs-var">getNeighbors</span></a><span>
</span><a name="line-16"></a><span class="hs-special">,</span><a href="CerkeFS.Internal.Board.html#sqKA"><span class="hs-identifier hs-var">sqKA</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqLA"><span class="hs-identifier hs-var">sqLA</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqNA"><span class="hs-identifier hs-var">sqNA</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqTA"><span class="hs-identifier hs-var">sqTA</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqZA"><span class="hs-identifier hs-var">sqZA</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqXA"><span class="hs-identifier hs-var">sqXA</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqCA"><span class="hs-identifier hs-var">sqCA</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqMA"><span class="hs-identifier hs-var">sqMA</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqPA"><span class="hs-identifier hs-var">sqPA</span></a><span class="hs-special">,</span><span> </span><span>
</span><a name="line-17"></a><span> </span><a href="CerkeFS.Internal.Board.html#sqKE"><span class="hs-identifier hs-var">sqKE</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqLE"><span class="hs-identifier hs-var">sqLE</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqNE"><span class="hs-identifier hs-var">sqNE</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqTE"><span class="hs-identifier hs-var">sqTE</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqZE"><span class="hs-identifier hs-var">sqZE</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqXE"><span class="hs-identifier hs-var">sqXE</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqCE"><span class="hs-identifier hs-var">sqCE</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqME"><span class="hs-identifier hs-var">sqME</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqPE"><span class="hs-identifier hs-var">sqPE</span></a><span class="hs-special">,</span><span> </span><span>
</span><a name="line-18"></a><span> </span><a href="CerkeFS.Internal.Board.html#sqKI"><span class="hs-identifier hs-var">sqKI</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqLI"><span class="hs-identifier hs-var">sqLI</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqNI"><span class="hs-identifier hs-var">sqNI</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqTI"><span class="hs-identifier hs-var">sqTI</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqZI"><span class="hs-identifier hs-var">sqZI</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqXI"><span class="hs-identifier hs-var">sqXI</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqCI"><span class="hs-identifier hs-var">sqCI</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqMI"><span class="hs-identifier hs-var">sqMI</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqPI"><span class="hs-identifier hs-var">sqPI</span></a><span class="hs-special">,</span><span> </span><span>
</span><a name="line-19"></a><span> </span><a href="CerkeFS.Internal.Board.html#sqKU"><span class="hs-identifier hs-var">sqKU</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqLU"><span class="hs-identifier hs-var">sqLU</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqNU"><span class="hs-identifier hs-var">sqNU</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqTU"><span class="hs-identifier hs-var">sqTU</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqZU"><span class="hs-identifier hs-var">sqZU</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqXU"><span class="hs-identifier hs-var">sqXU</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqCU"><span class="hs-identifier hs-var">sqCU</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqMU"><span class="hs-identifier hs-var">sqMU</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqPU"><span class="hs-identifier hs-var">sqPU</span></a><span class="hs-special">,</span><span> </span><span>
</span><a name="line-20"></a><span> </span><a href="CerkeFS.Internal.Board.html#sqKO"><span class="hs-identifier hs-var">sqKO</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqLO"><span class="hs-identifier hs-var">sqLO</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqNO"><span class="hs-identifier hs-var">sqNO</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqTO"><span class="hs-identifier hs-var">sqTO</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqZO"><span class="hs-identifier hs-var">sqZO</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqXO"><span class="hs-identifier hs-var">sqXO</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqCO"><span class="hs-identifier hs-var">sqCO</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqMO"><span class="hs-identifier hs-var">sqMO</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqPO"><span class="hs-identifier hs-var">sqPO</span></a><span class="hs-special">,</span><span> </span><span>
</span><a name="line-21"></a><span> </span><a href="CerkeFS.Internal.Board.html#sqKY"><span class="hs-identifier hs-var">sqKY</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqLY"><span class="hs-identifier hs-var">sqLY</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqNY"><span class="hs-identifier hs-var">sqNY</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqTY"><span class="hs-identifier hs-var">sqTY</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqZY"><span class="hs-identifier hs-var">sqZY</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqXY"><span class="hs-identifier hs-var">sqXY</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqCY"><span class="hs-identifier hs-var">sqCY</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqMY"><span class="hs-identifier hs-var">sqMY</span></a><span class="hs-special">,</span><span>  </span><a href="CerkeFS.Internal.Board.html#sqPY"><span class="hs-identifier hs-var">sqPY</span></a><span class="hs-special">,</span><span> </span><span>
</span><a name="line-22"></a><span> </span><a href="CerkeFS.Internal.Board.html#sqKAI"><span class="hs-identifier hs-var">sqKAI</span></a><span class="hs-special">,</span><span> </span><a href="CerkeFS.Internal.Board.html#sqLAI"><span class="hs-identifier hs-var">sqLAI</span></a><span class="hs-special">,</span><span> </span><a href="CerkeFS.Internal.Board.html#sqNAI"><span class="hs-identifier hs-var">sqNAI</span></a><span class="hs-special">,</span><span> </span><a href="CerkeFS.Internal.Board.html#sqTAI"><span class="hs-identifier hs-var">sqTAI</span></a><span class="hs-special">,</span><span> </span><a href="CerkeFS.Internal.Board.html#sqZAI"><span class="hs-identifier hs-var">sqZAI</span></a><span class="hs-special">,</span><span> </span><a href="CerkeFS.Internal.Board.html#sqXAI"><span class="hs-identifier hs-var">sqXAI</span></a><span class="hs-special">,</span><span> </span><a href="CerkeFS.Internal.Board.html#sqCAI"><span class="hs-identifier hs-var">sqCAI</span></a><span class="hs-special">,</span><span> </span><a href="CerkeFS.Internal.Board.html#sqMAI"><span class="hs-identifier hs-var">sqMAI</span></a><span class="hs-special">,</span><span> </span><a href="CerkeFS.Internal.Board.html#sqPAI"><span class="hs-identifier hs-var">sqPAI</span></a><span class="hs-special">,</span><span>
</span><a name="line-23"></a><span> </span><a href="CerkeFS.Internal.Board.html#sqKAU"><span class="hs-identifier hs-var">sqKAU</span></a><span class="hs-special">,</span><span> </span><a href="CerkeFS.Internal.Board.html#sqLAU"><span class="hs-identifier hs-var">sqLAU</span></a><span class="hs-special">,</span><span> </span><a href="CerkeFS.Internal.Board.html#sqNAU"><span class="hs-identifier hs-var">sqNAU</span></a><span class="hs-special">,</span><span> </span><a href="CerkeFS.Internal.Board.html#sqTAU"><span class="hs-identifier hs-var">sqTAU</span></a><span class="hs-special">,</span><span> </span><a href="CerkeFS.Internal.Board.html#sqZAU"><span class="hs-identifier hs-var">sqZAU</span></a><span class="hs-special">,</span><span> </span><a href="CerkeFS.Internal.Board.html#sqXAU"><span class="hs-identifier hs-var">sqXAU</span></a><span class="hs-special">,</span><span> </span><a href="CerkeFS.Internal.Board.html#sqCAU"><span class="hs-identifier hs-var">sqCAU</span></a><span class="hs-special">,</span><span> </span><a href="CerkeFS.Internal.Board.html#sqMAU"><span class="hs-identifier hs-var">sqMAU</span></a><span class="hs-special">,</span><span> </span><a href="CerkeFS.Internal.Board.html#sqPAU"><span class="hs-identifier hs-var">sqPAU</span></a><span class="hs-special">,</span><span>
</span><a name="line-24"></a><span> </span><a href="CerkeFS.Internal.Board.html#sqKIA"><span class="hs-identifier hs-var">sqKIA</span></a><span class="hs-special">,</span><span> </span><a href="CerkeFS.Internal.Board.html#sqLIA"><span class="hs-identifier hs-var">sqLIA</span></a><span class="hs-special">,</span><span> </span><a href="CerkeFS.Internal.Board.html#sqNIA"><span class="hs-identifier hs-var">sqNIA</span></a><span class="hs-special">,</span><span> </span><a href="CerkeFS.Internal.Board.html#sqTIA"><span class="hs-identifier hs-var">sqTIA</span></a><span class="hs-special">,</span><span> </span><a href="CerkeFS.Internal.Board.html#sqZIA"><span class="hs-identifier hs-var">sqZIA</span></a><span class="hs-special">,</span><span> </span><a href="CerkeFS.Internal.Board.html#sqXIA"><span class="hs-identifier hs-var">sqXIA</span></a><span class="hs-special">,</span><span> </span><a href="CerkeFS.Internal.Board.html#sqCIA"><span class="hs-identifier hs-var">sqCIA</span></a><span class="hs-special">,</span><span> </span><a href="CerkeFS.Internal.Board.html#sqMIA"><span class="hs-identifier hs-var">sqMIA</span></a><span class="hs-special">,</span><span> </span><a href="CerkeFS.Internal.Board.html#sqPIA"><span class="hs-identifier hs-var">sqPIA</span></a><span>
</span><a name="line-25"></a><span class="hs-special">,</span><a href="CerkeFS.Internal.Board.html#sqList"><span class="hs-identifier hs-var">sqList</span></a><span>
</span><a name="line-26"></a><span class="hs-special">,</span><a href="CerkeFS.Internal.Board.html#isTam2HueAUai1"><span class="hs-identifier hs-var">isTam2HueAUai1</span></a><span>
</span><a name="line-27"></a><span class="hs-special">,</span><a href="CerkeFS.Internal.Board.html#isOccupied"><span class="hs-identifier hs-var">isOccupied</span></a><span>
</span><a name="line-28"></a><span class="hs-special">,</span><a href="CerkeFS.Internal.Board.html#isTam2Hue"><span class="hs-identifier hs-var">isTam2Hue</span></a><span>
</span><a name="line-29"></a><span class="hs-special">,</span><a href="CerkeFS.Internal.Board.html#isNeighborOf"><span class="hs-identifier hs-var">isNeighborOf</span></a><span>
</span><a name="line-30"></a><span class="hs-comment">--,toEither</span><span>
</span><a name="line-31"></a><span class="hs-special">,</span><a href="CerkeFS.Internal.Board_Internal.html#Square2"><span class="hs-identifier hs-type">Square2</span></a><span class="hs-special">,</span><a href="CerkeFS.Internal.Board.html#fromBoard1_old"><span class="hs-identifier hs-var">fromBoard1_old</span></a><span class="hs-special">,</span><a href="CerkeFS.Internal.Board.html#toSquare"><span class="hs-identifier hs-var">toSquare</span></a><span class="hs-special">,</span><a href="CerkeFS.Internal.Board.html#fromSquare"><span class="hs-identifier hs-var">fromSquare</span></a><span>
</span><a name="line-32"></a><span class="hs-special">,</span><a href="CerkeFS.Internal.Board.html#isOccupied%27"><span class="hs-identifier hs-var">isOccupied'</span></a><span>
</span><a name="line-33"></a><span class="hs-special">,</span><a href="CerkeFS.Internal.Board.html#lookup_"><span class="hs-identifier hs-var">lookup_</span></a><span>
</span><a name="line-34"></a><span class="hs-comment">--,inherentTam2Hue'</span><span>
</span><a name="line-35"></a><span class="hs-special">,</span><a href="CerkeFS.Internal.Board.html#isInherentTam2Hue%27"><span class="hs-identifier hs-var">isInherentTam2Hue'</span></a><span>
</span><a name="line-36"></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span> </span><a href="CerkeFS.Piece3.html"><span class="hs-identifier">CerkeFS</span><span class="hs-operator">.</span><span class="hs-identifier">Piece3</span></a><span>
</span><a name="line-38"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">IntMap</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">I</span><span>
</span><a name="line-39"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-special">(</span><span class="hs-identifier hs-var">guard</span><span class="hs-special">)</span><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span><span class="hs-special">(</span><span class="hs-identifier hs-var">isJust</span><span class="hs-special">,</span><span class="hs-identifier hs-var">mapMaybe</span><span class="hs-special">)</span><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span> </span><a href="CerkeFS.Internal.Board_Internal.html"><span class="hs-identifier">CerkeFS</span><span class="hs-operator">.</span><span class="hs-identifier">Internal</span><span class="hs-operator">.</span><span class="hs-identifier">Board_Internal</span></a><span>
</span><a name="line-42"></a><span>
</span><a name="line-43"></a><span class="hs-keyword">data</span><span> </span><a name="Col"><a href="CerkeFS.Internal.Board.html#Col"><span class="hs-identifier">Col</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="ColumnK"><a href="CerkeFS.Internal.Board.html#ColumnK"><span class="hs-identifier">ColumnK</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="ColumnL"><a href="CerkeFS.Internal.Board.html#ColumnL"><span class="hs-identifier">ColumnL</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="ColumnN"><a href="CerkeFS.Internal.Board.html#ColumnN"><span class="hs-identifier">ColumnN</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="ColumnT"><a href="CerkeFS.Internal.Board.html#ColumnT"><span class="hs-identifier">ColumnT</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="ColumnZ"><a href="CerkeFS.Internal.Board.html#ColumnZ"><span class="hs-identifier">ColumnZ</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="ColumnX"><a href="CerkeFS.Internal.Board.html#ColumnX"><span class="hs-identifier">ColumnX</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="ColumnC"><a href="CerkeFS.Internal.Board.html#ColumnC"><span class="hs-identifier">ColumnC</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="ColumnM"><a href="CerkeFS.Internal.Board.html#ColumnM"><span class="hs-identifier">ColumnM</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="ColumnP"><a href="CerkeFS.Internal.Board.html#ColumnP"><span class="hs-identifier">ColumnP</span></a></a><span> </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">)</span><span>
</span><a name="line-44"></a><span class="hs-keyword">data</span><span> </span><a name="Row"><a href="CerkeFS.Internal.Board.html#Row"><span class="hs-identifier">Row</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="RowA"><a href="CerkeFS.Internal.Board.html#RowA"><span class="hs-identifier">RowA</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="RowE"><a href="CerkeFS.Internal.Board.html#RowE"><span class="hs-identifier">RowE</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="RowI"><a href="CerkeFS.Internal.Board.html#RowI"><span class="hs-identifier">RowI</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="RowU"><a href="CerkeFS.Internal.Board.html#RowU"><span class="hs-identifier">RowU</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="RowO"><a href="CerkeFS.Internal.Board.html#RowO"><span class="hs-identifier">RowO</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="RowY"><a href="CerkeFS.Internal.Board.html#RowY"><span class="hs-identifier">RowY</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="RowAI"><a href="CerkeFS.Internal.Board.html#RowAI"><span class="hs-identifier">RowAI</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="RowAU"><a href="CerkeFS.Internal.Board.html#RowAU"><span class="hs-identifier">RowAU</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="RowIA"><a href="CerkeFS.Internal.Board.html#RowIA"><span class="hs-identifier">RowIA</span></a></a><span> </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">)</span><span>
</span><a name="line-45"></a><span class="hs-keyword">data</span><span> </span><a name="Square"><a href="CerkeFS.Internal.Board.html#Square"><span class="hs-identifier">Square</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Square"><a href="CerkeFS.Internal.Board.html#Square"><span class="hs-identifier">Square</span></a></a><span class="hs-special">{</span><a name="row"><a href="CerkeFS.Internal.Board.html#row"><span class="hs-identifier">row</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="CerkeFS.Internal.Board.html#Row"><span class="hs-identifier hs-type">Row</span></a><span class="hs-special">,</span><span> </span><a name="col"><a href="CerkeFS.Internal.Board.html#col"><span class="hs-identifier">col</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="CerkeFS.Internal.Board.html#Col"><span class="hs-identifier hs-type">Col</span></a><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="CerkeFS.Internal.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-48"></a><span> </span><a name="local-8214565720323790232"><span class="hs-identifier">show</span></a><span> </span><a href="CerkeFS.Internal.Board.html#Square"><span class="hs-identifier hs-var">Square</span></a><span class="hs-special">{</span><span class="hs-identifier">col</span><span class="hs-glyph">=</span><a name="local-6989586621679030820"><a href="#local-6989586621679030820"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><span class="hs-identifier">row</span><span class="hs-glyph">=</span><a name="local-6989586621679030821"><a href="#local-6989586621679030821"><span class="hs-identifier">r</span></a></a><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;sq&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><span class="hs-string">&quot;Column&quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">drop</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679030820"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><span class="hs-string">&quot;Row&quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">drop</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679030821"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-49"></a><span>
</span><a name="line-50"></a><span class="hs-keyword">type</span><span> </span><a name="Board1_old"><a href="CerkeFS.Internal.Board.html#Board1_old"><span class="hs-identifier">Board1_old</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="CerkeFS.Internal.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span class="hs-special">,</span><span> </span><a href="CerkeFS.Internal.Piece2.html#Piece"><span class="hs-identifier hs-type">Piece</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span class="hs-keyword">data</span><span> </span><a name="Vec"><a href="CerkeFS.Internal.Board.html#Vec"><span class="hs-identifier">Vec</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Vec"><a href="CerkeFS.Internal.Board.html#Vec"><span class="hs-identifier">Vec</span></a></a><span class="hs-special">{</span><a name="dx"><a href="CerkeFS.Internal.Board.html#dx"><span class="hs-identifier">dx</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><a name="dy"><a href="CerkeFS.Internal.Board.html#dy"><span class="hs-identifier">dy</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-54"></a><span>
</span><a name="line-55"></a><span class="hs-comment">-- | Add a vector to the square to get a new square. 'Nothing' if it goes out of the board.</span><span>
</span><a name="line-56"></a><span class="hs-identifier">add</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CerkeFS.Internal.Board.html#Vec"><span class="hs-identifier hs-type">Vec</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Internal.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="CerkeFS.Internal.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span>
</span><a name="line-57"></a><a name="add"><a href="CerkeFS.Internal.Board.html#add"><span class="hs-identifier">add</span></a></a><span> </span><span class="hs-special">(</span><a href="CerkeFS.Internal.Board.html#Vec"><span class="hs-identifier hs-var">Vec</span></a><span> </span><a name="local-6989586621679032109"><a href="#local-6989586621679032109"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679032110"><a href="#local-6989586621679032110"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><a href="CerkeFS.Internal.Board.html#Square"><span class="hs-identifier hs-var">Square</span></a><span class="hs-special">{</span><span class="hs-identifier">col</span><span class="hs-glyph">=</span><a name="local-6989586621679032111"><a href="#local-6989586621679032111"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><span class="hs-identifier">row</span><span class="hs-glyph">=</span><a name="local-6989586621679032112"><a href="#local-6989586621679032112"><span class="hs-identifier">r</span></a></a><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-58"></a><span> </span><a name="local-6989586621679032113"><a href="#local-6989586621679032113"><span class="hs-identifier">new_c</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CerkeFS.Internal.Board.html#add%27"><span class="hs-identifier hs-var">add'</span></a><span> </span><a href="#local-6989586621679032109"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679032111"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-59"></a><span> </span><a name="local-6989586621679032114"><a href="#local-6989586621679032114"><span class="hs-identifier">new_r</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CerkeFS.Internal.Board.html#add%27"><span class="hs-identifier hs-var">add'</span></a><span> </span><a href="#local-6989586621679032110"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679032112"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-60"></a><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="CerkeFS.Internal.Board.html#Square"><span class="hs-identifier hs-var">Square</span></a><span class="hs-special">{</span><span class="hs-identifier">col</span><span class="hs-glyph">=</span><a href="#local-6989586621679032113"><span class="hs-identifier hs-var">new_c</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">row</span><span class="hs-glyph">=</span><a href="#local-6989586621679032114"><span class="hs-identifier hs-var">new_r</span></a><span class="hs-special">}</span><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-identifier">add_</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CerkeFS.Internal.Board.html#Vec"><span class="hs-identifier hs-type">Vec</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Internal.Board_Internal.html#Square2"><span class="hs-identifier hs-type">Square2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="CerkeFS.Internal.Board_Internal.html#Square2"><span class="hs-identifier hs-type">Square2</span></a><span>
</span><a name="line-63"></a><a name="add_"><a href="CerkeFS.Internal.Board.html#add_"><span class="hs-identifier">add_</span></a></a><span> </span><span class="hs-special">(</span><a href="CerkeFS.Internal.Board.html#Vec"><span class="hs-identifier hs-var">Vec</span></a><span> </span><a name="local-6989586621679032115"><a href="#local-6989586621679032115"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679032116"><a href="#local-6989586621679032116"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679032117"><a href="#local-6989586621679032117"><span class="hs-identifier">sq</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-64"></a><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679032118"><a href="#local-6989586621679032118"><span class="hs-identifier">r</span></a></a><span class="hs-special">,</span><a name="local-6989586621679032119"><a href="#local-6989586621679032119"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032117"><span class="hs-identifier hs-var">sq</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">divMod</span><span class="hs-special">`</span><span> </span><span class="hs-number">9</span><span>
</span><a name="line-65"></a><span> </span><a name="local-6989586621679032622"><a href="#local-6989586621679032622"><span class="hs-identifier">new_c</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CerkeFS.Internal.Board.html#add%27%27"><span class="hs-identifier hs-var">add''</span></a><span> </span><a href="#local-6989586621679032115"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679032119"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-66"></a><span> </span><a name="local-6989586621679032623"><a href="#local-6989586621679032623"><span class="hs-identifier">new_r</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CerkeFS.Internal.Board.html#add%27%27"><span class="hs-identifier hs-var">add''</span></a><span> </span><a href="#local-6989586621679032116"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679032118"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-67"></a><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679032623"><span class="hs-identifier hs-var">new_r</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-number">9</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679032622"><span class="hs-identifier hs-var">new_c</span></a><span>
</span><a name="line-68"></a><span>
</span><a name="line-69"></a><span class="hs-comment">--fromSquare :: Square -&gt; Square2</span><span>
</span><a name="line-70"></a><span class="hs-comment">--fromSquare (Square r c) = fromEnum r * 9 + fromEnum c</span><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span class="hs-comment">-- | Takes the difference of two squares as a vec. @p `minus` q@ is p minus q.</span><span>
</span><a name="line-73"></a><span class="hs-identifier">minus</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CerkeFS.Internal.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Internal.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Internal.Board.html#Vec"><span class="hs-identifier hs-type">Vec</span></a><span>
</span><a name="line-74"></a><a name="minus"><a href="CerkeFS.Internal.Board.html#minus"><span class="hs-identifier">minus</span></a></a><span> </span><a href="CerkeFS.Internal.Board.html#Square"><span class="hs-identifier hs-var">Square</span></a><span class="hs-special">{</span><span class="hs-identifier">col</span><span class="hs-glyph">=</span><a name="local-6989586621679032624"><a href="#local-6989586621679032624"><span class="hs-identifier">c1</span></a></a><span class="hs-special">,</span><span class="hs-identifier">row</span><span class="hs-glyph">=</span><a name="local-6989586621679032625"><a href="#local-6989586621679032625"><span class="hs-identifier">r1</span></a></a><span class="hs-special">}</span><span> </span><a href="CerkeFS.Internal.Board.html#Square"><span class="hs-identifier hs-var">Square</span></a><span class="hs-special">{</span><span class="hs-identifier">col</span><span class="hs-glyph">=</span><a name="local-6989586621679032626"><a href="#local-6989586621679032626"><span class="hs-identifier">c2</span></a></a><span class="hs-special">,</span><span class="hs-identifier">row</span><span class="hs-glyph">=</span><a name="local-6989586621679032627"><a href="#local-6989586621679032627"><span class="hs-identifier">r2</span></a></a><span class="hs-special">}</span><span>
</span><a name="line-75"></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CerkeFS.Internal.Board.html#Vec"><span class="hs-identifier hs-var">Vec</span></a><span class="hs-special">{</span><span class="hs-identifier">dx</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromEnum</span><span> </span><a href="#local-6989586621679032624"><span class="hs-identifier hs-var">c1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier hs-var">fromEnum</span><span> </span><a href="#local-6989586621679032626"><span class="hs-identifier hs-var">c2</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">dy</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromEnum</span><span> </span><a href="#local-6989586621679032625"><span class="hs-identifier hs-var">r1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier hs-var">fromEnum</span><span> </span><a href="#local-6989586621679032627"><span class="hs-identifier hs-var">r2</span></a><span class="hs-special">}</span><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span class="hs-identifier">add'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Enum</span><span> </span><a href="#local-6989586621679032108"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032108"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679032108"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-78"></a><a name="add%27"><a href="CerkeFS.Internal.Board.html#add%27"><span class="hs-identifier">add'</span></a></a><span> </span><a name="local-6989586621679032628"><a href="#local-6989586621679032628"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679032629"><a href="#local-6989586621679032629"><span class="hs-identifier">c</span></a></a><span>
</span><a name="line-79"></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679032628"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679032630"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span>
</span><a name="line-80"></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679032628"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679032630"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">8</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span>
</span><a name="line-81"></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">toEnum</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032628"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679032630"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-82"></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679032630"><a href="#local-6989586621679032630"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromEnum</span><span> </span><a href="#local-6989586621679032629"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-83"></a><span>
</span><a name="line-84"></a><span class="hs-identifier">add''</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-85"></a><a name="add%27%27"><a href="CerkeFS.Internal.Board.html#add%27%27"><span class="hs-identifier">add''</span></a></a><span> </span><a name="local-6989586621679032631"><a href="#local-6989586621679032631"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679032632"><a href="#local-6989586621679032632"><span class="hs-identifier">b</span></a></a><span>
</span><a name="line-86"></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679032631"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679032632"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span>
</span><a name="line-87"></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679032631"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679032632"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">8</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span>
</span><a name="line-88"></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679032631"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679032632"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span class="hs-identifier">toEither</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679032106"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679032107"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="#local-6989586621679032106"><span class="hs-identifier hs-type">c</span></a><span> </span><a href="#local-6989586621679032107"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-91"></a><a name="toEither"><a href="CerkeFS.Internal.Board.html#toEither"><span class="hs-identifier">toEither</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">maybe</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">Right</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Left</span><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span class="hs-keyword">data</span><span> </span><a name="Error"><a href="CerkeFS.Internal.Board.html#Error"><span class="hs-identifier">Error</span></a></a><span> </span><span>
</span><a name="line-94"></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="AlreadyOccupied"><a href="CerkeFS.Internal.Board.html#AlreadyOccupied"><span class="hs-identifier">AlreadyOccupied</span></a></a><span> </span><a href="CerkeFS.Internal.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span> </span><span class="hs-comment">-- ^ The square you're moving to is already occupied. </span><span>
</span><a name="line-95"></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="EmptySquare"><a href="CerkeFS.Internal.Board.html#EmptySquare"><span class="hs-identifier">EmptySquare</span></a></a><span> </span><a href="CerkeFS.Internal.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span> </span><span class="hs-comment">-- ^ The square you're moving from is actually empty</span><span>
</span><a name="line-96"></a><span>
</span><a name="line-97"></a><span class="hs-comment">-- ~ | OutOfBoard </span><span>
</span><a name="line-98"></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="TamCapture"><a href="CerkeFS.Internal.Board.html#TamCapture"><span class="hs-identifier">TamCapture</span></a></a><span> </span><span class="hs-comment">-- ^ The square you're moving to is already occupied by Tam2.</span><span>
</span><a name="line-99"></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="NoCorrespondingPieceInHand"><a href="CerkeFS.Internal.Board.html#NoCorrespondingPieceInHand"><span class="hs-identifier">NoCorrespondingPieceInHand</span></a></a><span> </span><span class="hs-comment">-- ^ You tried to drop a piece that is not in the hand.</span><span>
</span><a name="line-100"></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="MovingOpponentPiece"><a href="CerkeFS.Internal.Board.html#MovingOpponentPiece"><span class="hs-identifier">MovingOpponentPiece</span></a></a><span> </span><span class="hs-comment">-- ^ You tried to move the opponent's piece.</span><span>
</span><a name="line-101"></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="FriendlyFire"><a href="CerkeFS.Internal.Board.html#FriendlyFire"><span class="hs-identifier">FriendlyFire</span></a></a><span> </span><span class="hs-comment">-- ^ You tried to capture your own piece.</span><span>
</span><a name="line-102"></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="AmbiguousColor"><a href="CerkeFS.Internal.Board.html#AmbiguousColor"><span class="hs-identifier">AmbiguousColor</span></a></a><span> </span><span class="hs-comment">-- ^ Color of the dropped piece cannot be unambiguously inferred.</span><span>
</span><a name="line-103"></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="WrongProfessionSpecified"><a href="CerkeFS.Internal.Board.html#WrongProfessionSpecified"><span class="hs-identifier">WrongProfessionSpecified</span></a></a><span> </span><span class="hs-special">{</span><a name="expected"><a href="CerkeFS.Internal.Board.html#expected"><span class="hs-identifier">expected</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="CerkeFS.Internal.Piece2.html#Profession"><span class="hs-identifier hs-type">Profession</span></a><span class="hs-special">,</span><span> </span><a name="specified"><a href="CerkeFS.Internal.Board.html#specified"><span class="hs-identifier">specified</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="CerkeFS.Internal.Piece2.html#Profession"><span class="hs-identifier hs-type">Profession</span></a><span class="hs-special">}</span><span> </span><span class="hs-comment">-- ^ The actual profession differs from the expectation.</span><span>
</span><a name="line-104"></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="FalseDeclaration"><a href="CerkeFS.Internal.Board.html#FalseDeclaration"><span class="hs-identifier">FalseDeclaration</span></a></a><span> </span><span class="hs-comment">-- ^ Declares a Dat2 whose condition is not satisfied.</span><span>
</span><a name="line-105"></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Tam2HueAUai1Violation"><a href="CerkeFS.Internal.Board.html#Tam2HueAUai1Violation"><span class="hs-identifier">Tam2HueAUai1Violation</span></a></a><span> </span><span class="hs-comment">-- ^ Tried to take a piece protected by Tam2HueAUai1</span><span>
</span><a name="line-106"></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="SteppingEmptySquare"><a href="CerkeFS.Internal.Board.html#SteppingEmptySquare"><span class="hs-identifier">SteppingEmptySquare</span></a></a><span> </span><a href="CerkeFS.Internal.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span> </span><span class="hs-comment">-- ^ Tried to step on an empty square</span><span>
</span><a name="line-107"></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="ProfessionPrivilegeExceeded"><a href="CerkeFS.Internal.Board.html#ProfessionPrivilegeExceeded"><span class="hs-identifier">ProfessionPrivilegeExceeded</span></a></a><span> </span><a href="CerkeFS.Internal.Piece2.html#Profession"><span class="hs-identifier hs-type">Profession</span></a><span> </span><a href="CerkeFS.Internal.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span> </span><span class="hs-comment">-- ^ Trying a movement that the profession does not allow</span><span>
</span><a name="line-108"></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="CaptureByTam"><a href="CerkeFS.Internal.Board.html#CaptureByTam"><span class="hs-identifier">CaptureByTam</span></a></a><span> </span><span class="hs-comment">-- ^ Trying to capture a piece by Tam2</span><span>
</span><a name="line-109"></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Tam2PrivilegeExceeded"><a href="CerkeFS.Internal.Board.html#Tam2PrivilegeExceeded"><span class="hs-identifier">Tam2PrivilegeExceeded</span></a></a><span class="hs-special">{</span><span>
</span><a name="line-110"></a><span>  </span><a name="_from"><a href="CerkeFS.Internal.Board.html#_from"><span class="hs-identifier">_from</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="CerkeFS.Internal.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span class="hs-special">,</span><span>
</span><a name="line-111"></a><span>  </span><a name="_thru"><a href="CerkeFS.Internal.Board.html#_thru"><span class="hs-identifier">_thru</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="CerkeFS.Internal.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span class="hs-special">,</span><span>
</span><a name="line-112"></a><span>  </span><a name="_to"><a href="CerkeFS.Internal.Board.html#_to"><span class="hs-identifier">_to</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="CerkeFS.Internal.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span>
</span><a name="line-113"></a><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-comment">-- ^ Trying a movement that the Tam2 cannot do</span><span>
</span><a name="line-114"></a><span>  </span><span class="hs-keyword">deriving</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span> </span><span>
</span><a name="line-115"></a><span>
</span><a name="line-116"></a><span class="hs-comment">{-
********************************************
* Primitive operations on the board 
********************************************
-}</span><span>
</span><a name="line-121"></a><span class="hs-comment">-- -- | The list of squares that are inherently tam2Hue</span><span>
</span><a name="line-122"></a><span class="hs-comment">--inherentTam2Hue' :: [Square2]</span><span>
</span><a name="line-123"></a><span class="hs-comment">--inherentTam2Hue' = [20, 30, 40, 50, 60, 24, 32, 48, 56]</span><span>
</span><a name="line-124"></a><span> </span><span class="hs-comment">-- map fromSquare [sqNI, sqNAI, sqTU, sqTY, sqZO, sqXU, sqXY, sqCI, sqCAI]</span><span>
</span><a name="line-125"></a><span>
</span><a name="line-126"></a><span class="hs-identifier">getNeighborsAndSelf</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CerkeFS.Internal.Board_Internal.html#Square2"><span class="hs-identifier hs-type">Square2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CerkeFS.Internal.Board_Internal.html#Square2"><span class="hs-identifier hs-type">Square2</span></a><span class="hs-special">]</span><span>
</span><a name="line-127"></a><a name="getNeighborsAndSelf"><a href="CerkeFS.Internal.Board.html#getNeighborsAndSelf"><span class="hs-identifier">getNeighborsAndSelf</span></a></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-number">9</span><span class="hs-special">,</span><span class="hs-number">10</span><span class="hs-special">]</span><span>
</span><a name="line-128"></a><span class="hs-identifier">getNeighborsAndSelf</span><span> </span><span class="hs-number">8</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-number">7</span><span class="hs-special">,</span><span class="hs-number">8</span><span class="hs-special">,</span><span class="hs-number">16</span><span class="hs-special">,</span><span class="hs-number">17</span><span class="hs-special">]</span><span>
</span><a name="line-129"></a><span class="hs-identifier">getNeighborsAndSelf</span><span> </span><span class="hs-number">72</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-number">63</span><span class="hs-special">,</span><span class="hs-number">64</span><span class="hs-special">,</span><span class="hs-number">72</span><span class="hs-special">,</span><span class="hs-number">73</span><span class="hs-special">]</span><span>
</span><a name="line-130"></a><span class="hs-identifier">getNeighborsAndSelf</span><span> </span><span class="hs-number">80</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-number">70</span><span class="hs-special">,</span><span class="hs-number">71</span><span class="hs-special">,</span><span class="hs-number">79</span><span class="hs-special">,</span><span class="hs-number">80</span><span class="hs-special">]</span><span>
</span><a name="line-131"></a><span class="hs-identifier">getNeighborsAndSelf</span><span> </span><a name="local-6989586621679032633"><a href="#local-6989586621679032633"><span class="hs-identifier">a</span></a></a><span>
</span><a name="line-132"></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">7</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">8</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">9</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">10</span><span class="hs-special">]</span><span>
</span><a name="line-133"></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-number">73</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">79</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">10</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">9</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">8</span><span class="hs-special">]</span><span>
</span><a name="line-134"></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mod</span><span class="hs-special">`</span><span> </span><span class="hs-number">9</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">9</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">8</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">9</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">10</span><span class="hs-special">]</span><span>
</span><a name="line-135"></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mod</span><span class="hs-special">`</span><span> </span><span class="hs-number">9</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">8</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">9</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">10</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">9</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">8</span><span class="hs-special">]</span><span>
</span><a name="line-136"></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">10</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">9</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">8</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">8</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">9</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032633"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">10</span><span class="hs-special">]</span><span>
</span><a name="line-137"></a><span>
</span><a name="line-138"></a><span>
</span><a name="line-139"></a><span class="hs-comment">-- </span><span>
</span><a name="line-140"></a><span>
</span><a name="line-141"></a><span class="hs-identifier">getNeighbors</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CerkeFS.Internal.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CerkeFS.Internal.Board_Internal.html#Square2"><span class="hs-identifier hs-type">Square2</span></a><span class="hs-special">]</span><span>
</span><a name="line-142"></a><a name="getNeighbors"><a href="CerkeFS.Internal.Board.html#getNeighbors"><span class="hs-identifier">getNeighbors</span></a></a><span> </span><a name="local-6989586621679032634"><a href="#local-6989586621679032634"><span class="hs-identifier">sq</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CerkeFS.Internal.Board.html#getNeighbors%27"><span class="hs-identifier hs-var">getNeighbors'</span></a><span> </span><span class="hs-special">(</span><a href="CerkeFS.Internal.Board.html#fromSquare"><span class="hs-identifier hs-var">fromSquare</span></a><span> </span><a href="#local-6989586621679032634"><span class="hs-identifier hs-var">sq</span></a><span class="hs-special">)</span><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a><span class="hs-identifier">getNeighbors'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CerkeFS.Internal.Board_Internal.html#Square2"><span class="hs-identifier hs-type">Square2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="CerkeFS.Internal.Board_Internal.html#Square2"><span class="hs-identifier hs-type">Square2</span></a><span class="hs-special">]</span><span>
</span><a name="line-145"></a><a name="getNeighbors%27"><a href="CerkeFS.Internal.Board.html#getNeighbors%27"><span class="hs-identifier">getNeighbors'</span></a></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-number">9</span><span class="hs-special">,</span><span class="hs-number">10</span><span class="hs-special">]</span><span>
</span><a name="line-146"></a><span class="hs-identifier">getNeighbors'</span><span> </span><span class="hs-number">8</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-number">7</span><span class="hs-special">,</span><span class="hs-number">16</span><span class="hs-special">,</span><span class="hs-number">17</span><span class="hs-special">]</span><span>
</span><a name="line-147"></a><span class="hs-identifier">getNeighbors'</span><span> </span><span class="hs-number">72</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-number">63</span><span class="hs-special">,</span><span class="hs-number">64</span><span class="hs-special">,</span><span class="hs-number">73</span><span class="hs-special">]</span><span>
</span><a name="line-148"></a><span class="hs-identifier">getNeighbors'</span><span> </span><span class="hs-number">80</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-number">70</span><span class="hs-special">,</span><span class="hs-number">71</span><span class="hs-special">,</span><span class="hs-number">79</span><span class="hs-special">]</span><span>
</span><a name="line-149"></a><span class="hs-identifier">getNeighbors'</span><span> </span><a name="local-6989586621679032635"><a href="#local-6989586621679032635"><span class="hs-identifier">a</span></a></a><span>
</span><a name="line-150"></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679032635"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679032635"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">7</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679032635"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032635"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032635"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">8</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032635"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">9</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032635"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">10</span><span class="hs-special">]</span><span>
</span><a name="line-151"></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-number">73</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679032635"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679032635"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">79</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679032635"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032635"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032635"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">10</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032635"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">9</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032635"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">8</span><span class="hs-special">]</span><span>
</span><a name="line-152"></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679032635"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mod</span><span class="hs-special">`</span><span> </span><span class="hs-number">9</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621679032635"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032635"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">9</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032635"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">8</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032635"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">9</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032635"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">10</span><span class="hs-special">]</span><span>
</span><a name="line-153"></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679032635"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mod</span><span class="hs-special">`</span><span> </span><span class="hs-number">9</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">8</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679032635"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032635"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">9</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032635"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">10</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032635"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">9</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032635"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">8</span><span class="hs-special">]</span><span>
</span><a name="line-154"></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679032635"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">10</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032635"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">9</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032635"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">8</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032635"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032635"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032635"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">8</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032635"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">9</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032635"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">10</span><span class="hs-special">]</span><span>
</span><a name="line-155"></a><span>
</span><a name="line-156"></a><span class="hs-identifier">isNeighborOf</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CerkeFS.Internal.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Internal.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-157"></a><a name="isNeighborOf"><a href="CerkeFS.Internal.Board.html#isNeighborOf"><span class="hs-identifier">isNeighborOf</span></a></a><span> </span><a name="local-6989586621679032636"><a href="#local-6989586621679032636"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-6989586621679032637"><a href="#local-6989586621679032637"><span class="hs-identifier">s2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CerkeFS.Internal.Board.html#fromSquare"><span class="hs-identifier hs-var">fromSquare</span></a><span> </span><a href="#local-6989586621679032636"><span class="hs-identifier hs-var">s1</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="CerkeFS.Internal.Board.html#getNeighbors"><span class="hs-identifier hs-var">getNeighbors</span></a><span> </span><a href="#local-6989586621679032637"><span class="hs-identifier hs-var">s2</span></a><span>
</span><a name="line-158"></a><span>
</span><a name="line-159"></a><span class="hs-identifier">isNeighborOf'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CerkeFS.Internal.Board_Internal.html#Square2"><span class="hs-identifier hs-type">Square2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Internal.Board_Internal.html#Square2"><span class="hs-identifier hs-type">Square2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-160"></a><a name="isNeighborOf%27"><a href="CerkeFS.Internal.Board.html#isNeighborOf%27"><span class="hs-identifier">isNeighborOf'</span></a></a><span> </span><a name="local-6989586621679032638"><a href="#local-6989586621679032638"><span class="hs-identifier">s1</span></a></a><span> </span><a name="local-6989586621679032639"><a href="#local-6989586621679032639"><span class="hs-identifier">s2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032638"><span class="hs-identifier hs-var">s1</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="CerkeFS.Internal.Board.html#getNeighbors%27"><span class="hs-identifier hs-var">getNeighbors'</span></a><span> </span><a href="#local-6989586621679032639"><span class="hs-identifier hs-var">s2</span></a><span>
</span><a name="line-161"></a><span>
</span><a name="line-162"></a><span class="hs-comment">-- | Checks whether the piece on a given square is a Tam2HueAUai1 that belong to the side.</span><span>
</span><a name="line-163"></a><span class="hs-identifier">isTam2HueAUai1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CerkeFS.Internal.Piece2.html#Side"><span class="hs-identifier hs-type">Side</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Internal.Board_Internal.html#Board1"><span class="hs-identifier hs-type">Board1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Internal.Board_Internal.html#Square2"><span class="hs-identifier hs-type">Square2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-164"></a><a name="isTam2HueAUai1"><a href="CerkeFS.Internal.Board.html#isTam2HueAUai1"><span class="hs-identifier">isTam2HueAUai1</span></a></a><span> </span><a name="local-6989586621679032640"><a href="#local-6989586621679032640"><span class="hs-identifier">sid</span></a></a><span> </span><a name="local-6989586621679032641"><a href="#local-6989586621679032641"><span class="hs-identifier">board</span></a></a><span> </span><a name="local-6989586621679032642"><a href="#local-6989586621679032642"><span class="hs-identifier">sq</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isJust</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-165"></a><span> </span><a name="local-6989586621679032643"><a href="#local-6989586621679032643"><span class="hs-identifier">piece</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679032642"><span class="hs-identifier hs-var">sq</span></a><span> </span><span class="hs-special">`</span><a href="CerkeFS.Internal.Board_Internal.html#iLookup"><span class="hs-identifier hs-var">iLookup</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier">unBoard1</span><span> </span><a href="#local-6989586621679032641"><span class="hs-identifier hs-var">board</span></a><span>
</span><a name="line-166"></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a href="CerkeFS.Internal.Piece2.html#Uai1"><span class="hs-identifier hs-var">Uai1</span></a><span class="hs-special">,</span><a name="local-6989586621679032644"><a href="#local-6989586621679032644"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CerkeFS.Piece3.html#toPhantom"><span class="hs-identifier hs-var">toPhantom</span></a><span> </span><a href="#local-6989586621679032643"><span class="hs-identifier hs-var">piece</span></a><span>
</span><a name="line-167"></a><span> </span><span class="hs-identifier hs-var">guard</span><span class="hs-special">(</span><a href="#local-6989586621679032644"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679032640"><span class="hs-identifier hs-var">sid</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="CerkeFS.Internal.Board.html#isTam2Hue"><span class="hs-identifier hs-var">isTam2Hue</span></a><span> </span><a href="#local-6989586621679032641"><span class="hs-identifier hs-var">board</span></a><span> </span><a href="#local-6989586621679032642"><span class="hs-identifier hs-var">sq</span></a><span class="hs-special">)</span><span>
</span><a name="line-168"></a><span>
</span><a name="line-169"></a><a name="isInherentTam2Hue%27"><a href="CerkeFS.Internal.Board.html#isInherentTam2Hue%27"><span class="hs-identifier">isInherentTam2Hue'</span></a></a><span> </span><a name="local-6989586621679032645"><a href="#local-6989586621679032645"><span class="hs-identifier">sq</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">20</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679032645"><span class="hs-identifier hs-var">sq</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679032645"><span class="hs-identifier hs-var">sq</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">60</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032645"><span class="hs-identifier hs-var">sq</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">rem</span><span class="hs-special">`</span><span> </span><span class="hs-number">10</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679032645"><span class="hs-identifier hs-var">sq</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">rem</span><span class="hs-special">`</span><span> </span><span class="hs-number">8</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-170"></a><span>
</span><a name="line-171"></a><span class="hs-comment">-- | Checks whether a given square is in Tam2Hue.</span><span>
</span><a name="line-172"></a><span class="hs-identifier">isTam2Hue</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CerkeFS.Internal.Board_Internal.html#Board1"><span class="hs-identifier hs-type">Board1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Internal.Board_Internal.html#Square2"><span class="hs-identifier hs-type">Square2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-173"></a><a name="isTam2Hue"><a href="CerkeFS.Internal.Board.html#isTam2Hue"><span class="hs-identifier">isTam2Hue</span></a></a><span> </span><a name="local-6989586621679032646"><a href="#local-6989586621679032646"><span class="hs-identifier">board</span></a></a><span> </span><a name="local-6989586621679032647"><a href="#local-6989586621679032647"><span class="hs-identifier">sq</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CerkeFS.Internal.Board.html#isInherentTam2Hue%27"><span class="hs-identifier hs-var">isInherentTam2Hue'</span></a><span> </span><a href="#local-6989586621679032647"><span class="hs-identifier hs-var">sq</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><span>
</span><a name="line-174"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679032648"><a href="#local-6989586621679032648"><span class="hs-identifier">ps</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapMaybe</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><a href="CerkeFS.Internal.Board_Internal.html#iLookup"><span class="hs-identifier hs-var">iLookup</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier">unBoard1</span><span> </span><a href="#local-6989586621679032646"><span class="hs-identifier hs-var">board</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="CerkeFS.Internal.Board.html#getNeighborsAndSelf"><span class="hs-identifier hs-var">getNeighborsAndSelf</span></a><span> </span><a href="#local-6989586621679032647"><span class="hs-identifier hs-var">sq</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-175"></a><span>   </span><a href="CerkeFS.Piece3.html#phantomTam"><span class="hs-identifier hs-var">phantomTam</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="CerkeFS.Piece3.html#toPhantom"><span class="hs-identifier hs-var">toPhantom</span></a><span> </span><a href="#local-6989586621679032648"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-176"></a><span>
</span><a name="line-177"></a><span class="hs-comment">-- | Returns whether the square is occupied</span><span>
</span><a name="line-178"></a><span class="hs-identifier">isOccupied</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CerkeFS.Internal.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Internal.Board_Internal.html#Board1"><span class="hs-identifier hs-type">Board1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-179"></a><a name="isOccupied"><a href="CerkeFS.Internal.Board.html#isOccupied"><span class="hs-identifier">isOccupied</span></a></a><span> </span><a name="local-6989586621679032649"><a href="#local-6989586621679032649"><span class="hs-identifier">sq</span></a></a><span> </span><span class="hs-special">(</span><a href="CerkeFS.Internal.Board_Internal.html#Board1"><span class="hs-identifier hs-var">Board1</span></a><span> </span><a name="local-6989586621679032650"><a href="#local-6989586621679032650"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="CerkeFS.Internal.Board_Internal.html#iMember"><span class="hs-identifier hs-var">iMember</span></a><span> </span><span class="hs-special">(</span><a href="CerkeFS.Internal.Board.html#fromSquare"><span class="hs-identifier hs-var">fromSquare</span></a><span> </span><a href="#local-6989586621679032649"><span class="hs-identifier hs-var">sq</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032650"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-180"></a><span>
</span><a name="line-181"></a><span class="hs-identifier">isOccupied'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CerkeFS.Internal.Board_Internal.html#Square2"><span class="hs-identifier hs-type">Square2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Internal.Board_Internal.html#Board1"><span class="hs-identifier hs-type">Board1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-182"></a><a name="isOccupied%27"><a href="CerkeFS.Internal.Board.html#isOccupied%27"><span class="hs-identifier">isOccupied'</span></a></a><span> </span><a name="local-6989586621679032651"><a href="#local-6989586621679032651"><span class="hs-identifier">sq</span></a></a><span> </span><span class="hs-special">(</span><a href="CerkeFS.Internal.Board_Internal.html#Board1"><span class="hs-identifier hs-var">Board1</span></a><span> </span><a name="local-6989586621679032652"><a href="#local-6989586621679032652"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="CerkeFS.Internal.Board_Internal.html#iMember"><span class="hs-identifier hs-var">iMember</span></a><span> </span><a href="#local-6989586621679032651"><span class="hs-identifier hs-var">sq</span></a><span> </span><a href="#local-6989586621679032652"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-183"></a><span>
</span><a name="line-184"></a><span class="hs-comment">-- | Puts a piece on a square. Fails with 'AlreadyOccupied' if already occupied.</span><span>
</span><a name="line-185"></a><span class="hs-identifier">putPiece</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CerkeFS.Internal.Piece2.html#Piece"><span class="hs-identifier hs-type">Piece</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Internal.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Internal.Board_Internal.html#Board1"><span class="hs-identifier hs-type">Board1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="CerkeFS.Internal.Board.html#Error"><span class="hs-identifier hs-type">Error</span></a><span> </span><a href="CerkeFS.Internal.Board_Internal.html#Board1"><span class="hs-identifier hs-type">Board1</span></a><span>
</span><a name="line-186"></a><a name="putPiece"><a href="CerkeFS.Internal.Board.html#putPiece"><span class="hs-identifier">putPiece</span></a></a><span> </span><a name="local-6989586621679032653"><a href="#local-6989586621679032653"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679032654"><a href="#local-6989586621679032654"><span class="hs-identifier">sq</span></a></a><span> </span><a name="local-6989586621679032655"><a href="#local-6989586621679032655"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><a name="line-187"></a><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679032654"><span class="hs-identifier hs-var">sq</span></a><span> </span><span class="hs-special">`</span><a href="CerkeFS.Internal.Board.html#isOccupied"><span class="hs-identifier hs-var">isOccupied</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679032655"><span class="hs-identifier hs-var">b</span></a><span> </span><span>
</span><a name="line-188"></a><span>  </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><a href="CerkeFS.Internal.Board.html#AlreadyOccupied"><span class="hs-identifier hs-var">AlreadyOccupied</span></a><span> </span><a href="#local-6989586621679032654"><span class="hs-identifier hs-var">sq</span></a><span class="hs-special">)</span><span> </span><span>
</span><a name="line-189"></a><span>  </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Right</span><span class="hs-special">(</span><a href="CerkeFS.Internal.Board_Internal.html#Board1"><span class="hs-identifier hs-var">Board1</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="CerkeFS.Internal.Board_Internal.html#iInsert"><span class="hs-identifier hs-var">iInsert</span></a><span> </span><span class="hs-special">(</span><a href="CerkeFS.Internal.Board.html#fromSquare"><span class="hs-identifier hs-var">fromSquare</span></a><span> </span><a href="#local-6989586621679032654"><span class="hs-identifier hs-var">sq</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032653"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">unBoard1</span><span> </span><a href="#local-6989586621679032655"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-190"></a><span>
</span><a name="line-191"></a><span class="hs-comment">-- | Removes a piece. Fails with 'EmptySquare' if the specified square is empty.</span><span>
</span><a name="line-192"></a><span class="hs-identifier">removePiece</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CerkeFS.Internal.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Internal.Board_Internal.html#Board1"><span class="hs-identifier hs-type">Board1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="CerkeFS.Internal.Board.html#Error"><span class="hs-identifier hs-type">Error</span></a><span> </span><span class="hs-special">(</span><a href="CerkeFS.Internal.Piece2.html#Piece"><span class="hs-identifier hs-type">Piece</span></a><span class="hs-special">,</span><span> </span><a href="CerkeFS.Internal.Board_Internal.html#Board1"><span class="hs-identifier hs-type">Board1</span></a><span class="hs-special">)</span><span>
</span><a name="line-193"></a><a name="removePiece"><a href="CerkeFS.Internal.Board.html#removePiece"><span class="hs-identifier">removePiece</span></a></a><span> </span><a name="local-6989586621679032656"><a href="#local-6989586621679032656"><span class="hs-identifier">sq</span></a></a><span> </span><span class="hs-special">(</span><a href="CerkeFS.Internal.Board_Internal.html#Board1"><span class="hs-identifier hs-var">Board1</span></a><span> </span><a name="local-6989586621679032657"><a href="#local-6989586621679032657"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="CerkeFS.Internal.Board.html#toEither"><span class="hs-identifier hs-var">toEither</span></a><span> </span><span class="hs-special">(</span><a href="CerkeFS.Internal.Board.html#EmptySquare"><span class="hs-identifier hs-var">EmptySquare</span></a><span> </span><a href="#local-6989586621679032656"><span class="hs-identifier hs-var">sq</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-194"></a><span> </span><a name="local-6989586621679032658"><a href="#local-6989586621679032658"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679032656"><span class="hs-identifier hs-var">sq</span></a><span> </span><span class="hs-special">`</span><a href="CerkeFS.Internal.Board.html#lookup_"><span class="hs-identifier hs-var">lookup_</span></a><span class="hs-special">`</span><span> </span><a href="CerkeFS.Internal.Board_Internal.html#Board1"><span class="hs-identifier hs-var">Board1</span></a><span> </span><a href="#local-6989586621679032657"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-195"></a><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032658"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">,</span><span> </span><a href="CerkeFS.Internal.Board_Internal.html#Board1"><span class="hs-identifier hs-var">Board1</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="CerkeFS.Internal.Board.html#fromSquare"><span class="hs-identifier hs-var">fromSquare</span></a><span> </span><a href="#local-6989586621679032656"><span class="hs-identifier hs-var">sq</span></a><span> </span><span class="hs-special">`</span><a href="CerkeFS.Internal.Board_Internal.html#iDelete"><span class="hs-identifier hs-var">iDelete</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679032657"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-196"></a><span>
</span><a name="line-197"></a><span class="hs-identifier">lookup_</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CerkeFS.Internal.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Internal.Board_Internal.html#Board1"><span class="hs-identifier hs-type">Board1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="CerkeFS.Internal.Piece2.html#Piece"><span class="hs-identifier hs-type">Piece</span></a><span>
</span><a name="line-198"></a><a name="lookup_"><a href="CerkeFS.Internal.Board.html#lookup_"><span class="hs-identifier">lookup_</span></a></a><span> </span><a name="local-6989586621679032659"><a href="#local-6989586621679032659"><span class="hs-identifier">sq</span></a></a><span> </span><span class="hs-special">(</span><a href="CerkeFS.Internal.Board_Internal.html#Board1"><span class="hs-identifier hs-var">Board1</span></a><span> </span><a name="local-6989586621679032660"><a href="#local-6989586621679032660"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="CerkeFS.Internal.Board.html#fromSquare"><span class="hs-identifier hs-var">fromSquare</span></a><span> </span><a href="#local-6989586621679032659"><span class="hs-identifier hs-var">sq</span></a><span> </span><span class="hs-special">`</span><a href="CerkeFS.Internal.Board_Internal.html#iLookup"><span class="hs-identifier hs-var">iLookup</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679032660"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-199"></a><span>
</span><a name="line-200"></a><span class="hs-comment">-- | Moves a piece on a square according to the vector. Raises: </span><span>
</span><a name="line-201"></a><span class="hs-comment">--</span><span>
</span><a name="line-202"></a><span class="hs-comment">--   * 'OutOfBoard' if the piece goes out of the board</span><span>
</span><a name="line-203"></a><span class="hs-comment">--   * 'EmptySquare' if the original square is empty</span><span>
</span><a name="line-204"></a><span class="hs-comment">--   * 'AlreadyOccupied' if the resulting square is already occupied</span><span>
</span><a name="line-205"></a><span class="hs-comment">{-
movePiece :: Vec -&gt; Square -&gt; Board1 -&gt; M Board1
movePiece vec sq b = do
 (p, new_b) &lt;- removePiece sq b
 new_sq &lt;- toEither OutOfBoard $ add vec sq
 putPiece p new_sq new_b
-}</span><span>
</span><a name="line-212"></a><span>
</span><a name="line-213"></a><span class="hs-comment">-- | Moves a piece from a square to a square, returning the phantom version of the piece that was moved. Raises: </span><span>
</span><a name="line-214"></a><span class="hs-comment">--</span><span>
</span><a name="line-215"></a><span class="hs-comment">--   * 'EmptySquare' if the original square is empty</span><span>
</span><a name="line-216"></a><span class="hs-comment">--   * 'AlreadyOccupied' if the resulting square is already occupied</span><span>
</span><a name="line-217"></a><span class="hs-identifier">movePieceFromToFull</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CerkeFS.Internal.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Internal.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Internal.Board_Internal.html#Board1"><span class="hs-identifier hs-type">Board1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="CerkeFS.Internal.Board.html#Error"><span class="hs-identifier hs-type">Error</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="CerkeFS.Piece3.html#PhantomPiece"><span class="hs-identifier hs-type">PhantomPiece</span></a><span class="hs-special">,</span><span> </span><a href="CerkeFS.Internal.Board_Internal.html#Board1"><span class="hs-identifier hs-type">Board1</span></a><span class="hs-special">)</span><span>
</span><a name="line-218"></a><a name="movePieceFromToFull"><a href="CerkeFS.Internal.Board.html#movePieceFromToFull"><span class="hs-identifier">movePieceFromToFull</span></a></a><span> </span><a name="local-6989586621679032661"><a href="#local-6989586621679032661"><span class="hs-identifier">from</span></a></a><span> </span><a name="local-6989586621679032662"><a href="#local-6989586621679032662"><span class="hs-identifier">to</span></a></a><span> </span><a name="local-6989586621679032663"><a href="#local-6989586621679032663"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-219"></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679032664"><a href="#local-6989586621679032664"><span class="hs-identifier">p</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679032665"><a href="#local-6989586621679032665"><span class="hs-identifier">new_b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CerkeFS.Internal.Board.html#removePiece"><span class="hs-identifier hs-var">removePiece</span></a><span> </span><a href="#local-6989586621679032661"><span class="hs-identifier hs-var">from</span></a><span> </span><a href="#local-6989586621679032663"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-220"></a><span> </span><a name="local-6989586621679032666"><a href="#local-6989586621679032666"><span class="hs-identifier">newerBoard</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="CerkeFS.Internal.Board.html#putPiece"><span class="hs-identifier hs-var">putPiece</span></a><span> </span><a href="#local-6989586621679032664"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679032662"><span class="hs-identifier hs-var">to</span></a><span> </span><a href="#local-6989586621679032665"><span class="hs-identifier hs-var">new_b</span></a><span>
</span><a name="line-221"></a><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="CerkeFS.Piece3.html#toPhantom"><span class="hs-identifier hs-var">toPhantom</span></a><span> </span><a href="#local-6989586621679032664"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032666"><span class="hs-identifier hs-var">newerBoard</span></a><span class="hs-special">)</span><span>
</span><a name="line-222"></a><span>
</span><a name="line-223"></a><span class="hs-comment">-- | The list of squares, arranged in the following order: @['sqKA', 'sqLA', 'sqNA' ... 'sqCIA', 'sqMIA', 'sqPIA']@.</span><span>
</span><a name="line-224"></a><span class="hs-identifier">sqList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="CerkeFS.Internal.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span class="hs-special">]</span><span>
</span><a name="line-225"></a><a name="sqList"><a href="CerkeFS.Internal.Board.html#sqList"><span class="hs-identifier">sqList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="CerkeFS.Internal.Board.html#Square"><span class="hs-identifier hs-var">Square</span></a><span> </span><a href="#local-6989586621679032667"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679032668"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679032667"><a href="#local-6989586621679032667"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span class="hs-special">[</span><a href="CerkeFS.Internal.Board.html#RowA"><span class="hs-identifier hs-var">RowA</span></a><span> </span><span class="hs-glyph">..</span><a href="CerkeFS.Internal.Board.html#RowIA"><span class="hs-identifier hs-var">RowIA</span></a><span class="hs-special">]</span><span class="hs-special">,</span><a name="local-6989586621679032668"><a href="#local-6989586621679032668"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span class="hs-special">[</span><a href="CerkeFS.Internal.Board.html#ColumnK"><span class="hs-identifier hs-var">ColumnK</span></a><span> </span><span class="hs-glyph">..</span><span> </span><a href="CerkeFS.Internal.Board.html#ColumnP"><span class="hs-identifier hs-var">ColumnP</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-226"></a><span>
</span><a name="line-227"></a><span class="hs-identifier">sqKA</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqLA</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqNA</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqTA</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqZA</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqXA</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqCA</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqMA</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqPA</span><span class="hs-special">,</span><span> </span><span>
</span><a name="line-228"></a><span> </span><span class="hs-identifier">sqKE</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqLE</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqNE</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqTE</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqZE</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqXE</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqCE</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqME</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqPE</span><span class="hs-special">,</span><span> </span><span>
</span><a name="line-229"></a><span> </span><span class="hs-identifier">sqKI</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqLI</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqNI</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqTI</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqZI</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqXI</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqCI</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqMI</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqPI</span><span class="hs-special">,</span><span> </span><span>
</span><a name="line-230"></a><span> </span><span class="hs-identifier">sqKU</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqLU</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqNU</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqTU</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqZU</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqXU</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqCU</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqMU</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqPU</span><span class="hs-special">,</span><span> </span><span>
</span><a name="line-231"></a><span> </span><span class="hs-identifier">sqKO</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqLO</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqNO</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqTO</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqZO</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqXO</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqCO</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqMO</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqPO</span><span class="hs-special">,</span><span> </span><span>
</span><a name="line-232"></a><span> </span><span class="hs-identifier">sqKY</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqLY</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqNY</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqTY</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqZY</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqXY</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqCY</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqMY</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier">sqPY</span><span class="hs-special">,</span><span> </span><span>
</span><a name="line-233"></a><span> </span><span class="hs-identifier">sqKAI</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqLAI</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqNAI</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqTAI</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqZAI</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqXAI</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqCAI</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqMAI</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqPAI</span><span class="hs-special">,</span><span>
</span><a name="line-234"></a><span> </span><span class="hs-identifier">sqKAU</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqLAU</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqNAU</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqTAU</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqZAU</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqXAU</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqCAU</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqMAU</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqPAU</span><span class="hs-special">,</span><span>
</span><a name="line-235"></a><span> </span><span class="hs-identifier">sqKIA</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqLIA</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqNIA</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqTIA</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqZIA</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqXIA</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqCIA</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqMIA</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sqPIA</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CerkeFS.Internal.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span>
</span><a name="line-236"></a><span class="hs-special">[</span><span>
</span><a name="line-237"></a><span> </span><a name="local-8214565720323805647"><a href="CerkeFS.Internal.Board.html#sqKA"><span class="hs-identifier">sqKA</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805648"><a href="CerkeFS.Internal.Board.html#sqLA"><span class="hs-identifier">sqLA</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805649"><a href="CerkeFS.Internal.Board.html#sqNA"><span class="hs-identifier">sqNA</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805650"><a href="CerkeFS.Internal.Board.html#sqTA"><span class="hs-identifier">sqTA</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805651"><a href="CerkeFS.Internal.Board.html#sqZA"><span class="hs-identifier">sqZA</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805652"><a href="CerkeFS.Internal.Board.html#sqXA"><span class="hs-identifier">sqXA</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805653"><a href="CerkeFS.Internal.Board.html#sqCA"><span class="hs-identifier">sqCA</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805654"><a href="CerkeFS.Internal.Board.html#sqMA"><span class="hs-identifier">sqMA</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805655"><a href="CerkeFS.Internal.Board.html#sqPA"><span class="hs-identifier">sqPA</span></a></a><span class="hs-special">,</span><span> </span><span>
</span><a name="line-238"></a><span> </span><a name="local-8214565720323805656"><a href="CerkeFS.Internal.Board.html#sqKE"><span class="hs-identifier">sqKE</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805657"><a href="CerkeFS.Internal.Board.html#sqLE"><span class="hs-identifier">sqLE</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805658"><a href="CerkeFS.Internal.Board.html#sqNE"><span class="hs-identifier">sqNE</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805659"><a href="CerkeFS.Internal.Board.html#sqTE"><span class="hs-identifier">sqTE</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805660"><a href="CerkeFS.Internal.Board.html#sqZE"><span class="hs-identifier">sqZE</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805661"><a href="CerkeFS.Internal.Board.html#sqXE"><span class="hs-identifier">sqXE</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805662"><a href="CerkeFS.Internal.Board.html#sqCE"><span class="hs-identifier">sqCE</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805663"><a href="CerkeFS.Internal.Board.html#sqME"><span class="hs-identifier">sqME</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805664"><a href="CerkeFS.Internal.Board.html#sqPE"><span class="hs-identifier">sqPE</span></a></a><span class="hs-special">,</span><span> </span><span>
</span><a name="line-239"></a><span> </span><a name="local-8214565720323805665"><a href="CerkeFS.Internal.Board.html#sqKI"><span class="hs-identifier">sqKI</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805666"><a href="CerkeFS.Internal.Board.html#sqLI"><span class="hs-identifier">sqLI</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805667"><a href="CerkeFS.Internal.Board.html#sqNI"><span class="hs-identifier">sqNI</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805668"><a href="CerkeFS.Internal.Board.html#sqTI"><span class="hs-identifier">sqTI</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805669"><a href="CerkeFS.Internal.Board.html#sqZI"><span class="hs-identifier">sqZI</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805670"><a href="CerkeFS.Internal.Board.html#sqXI"><span class="hs-identifier">sqXI</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805671"><a href="CerkeFS.Internal.Board.html#sqCI"><span class="hs-identifier">sqCI</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805672"><a href="CerkeFS.Internal.Board.html#sqMI"><span class="hs-identifier">sqMI</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805673"><a href="CerkeFS.Internal.Board.html#sqPI"><span class="hs-identifier">sqPI</span></a></a><span class="hs-special">,</span><span> </span><span>
</span><a name="line-240"></a><span> </span><a name="local-8214565720323805674"><a href="CerkeFS.Internal.Board.html#sqKU"><span class="hs-identifier">sqKU</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805675"><a href="CerkeFS.Internal.Board.html#sqLU"><span class="hs-identifier">sqLU</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805676"><a href="CerkeFS.Internal.Board.html#sqNU"><span class="hs-identifier">sqNU</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805677"><a href="CerkeFS.Internal.Board.html#sqTU"><span class="hs-identifier">sqTU</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805678"><a href="CerkeFS.Internal.Board.html#sqZU"><span class="hs-identifier">sqZU</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805679"><a href="CerkeFS.Internal.Board.html#sqXU"><span class="hs-identifier">sqXU</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805680"><a href="CerkeFS.Internal.Board.html#sqCU"><span class="hs-identifier">sqCU</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805681"><a href="CerkeFS.Internal.Board.html#sqMU"><span class="hs-identifier">sqMU</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805682"><a href="CerkeFS.Internal.Board.html#sqPU"><span class="hs-identifier">sqPU</span></a></a><span class="hs-special">,</span><span> </span><span>
</span><a name="line-241"></a><span> </span><a name="local-8214565720323805683"><a href="CerkeFS.Internal.Board.html#sqKO"><span class="hs-identifier">sqKO</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805684"><a href="CerkeFS.Internal.Board.html#sqLO"><span class="hs-identifier">sqLO</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805685"><a href="CerkeFS.Internal.Board.html#sqNO"><span class="hs-identifier">sqNO</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805686"><a href="CerkeFS.Internal.Board.html#sqTO"><span class="hs-identifier">sqTO</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805687"><a href="CerkeFS.Internal.Board.html#sqZO"><span class="hs-identifier">sqZO</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805688"><a href="CerkeFS.Internal.Board.html#sqXO"><span class="hs-identifier">sqXO</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805689"><a href="CerkeFS.Internal.Board.html#sqCO"><span class="hs-identifier">sqCO</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805690"><a href="CerkeFS.Internal.Board.html#sqMO"><span class="hs-identifier">sqMO</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805691"><a href="CerkeFS.Internal.Board.html#sqPO"><span class="hs-identifier">sqPO</span></a></a><span class="hs-special">,</span><span> </span><span>
</span><a name="line-242"></a><span> </span><a name="local-8214565720323805692"><a href="CerkeFS.Internal.Board.html#sqKY"><span class="hs-identifier">sqKY</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805693"><a href="CerkeFS.Internal.Board.html#sqLY"><span class="hs-identifier">sqLY</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805694"><a href="CerkeFS.Internal.Board.html#sqNY"><span class="hs-identifier">sqNY</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805695"><a href="CerkeFS.Internal.Board.html#sqTY"><span class="hs-identifier">sqTY</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805696"><a href="CerkeFS.Internal.Board.html#sqZY"><span class="hs-identifier">sqZY</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805697"><a href="CerkeFS.Internal.Board.html#sqXY"><span class="hs-identifier">sqXY</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805698"><a href="CerkeFS.Internal.Board.html#sqCY"><span class="hs-identifier">sqCY</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805699"><a href="CerkeFS.Internal.Board.html#sqMY"><span class="hs-identifier">sqMY</span></a></a><span class="hs-special">,</span><span>  </span><a name="local-8214565720323805700"><a href="CerkeFS.Internal.Board.html#sqPY"><span class="hs-identifier">sqPY</span></a></a><span class="hs-special">,</span><span> </span><span>
</span><a name="line-243"></a><span> </span><a name="local-8214565720323805701"><a href="CerkeFS.Internal.Board.html#sqKAI"><span class="hs-identifier">sqKAI</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720323805702"><a href="CerkeFS.Internal.Board.html#sqLAI"><span class="hs-identifier">sqLAI</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720323805703"><a href="CerkeFS.Internal.Board.html#sqNAI"><span class="hs-identifier">sqNAI</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720323805704"><a href="CerkeFS.Internal.Board.html#sqTAI"><span class="hs-identifier">sqTAI</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720323805705"><a href="CerkeFS.Internal.Board.html#sqZAI"><span class="hs-identifier">sqZAI</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720323805706"><a href="CerkeFS.Internal.Board.html#sqXAI"><span class="hs-identifier">sqXAI</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720323805707"><a href="CerkeFS.Internal.Board.html#sqCAI"><span class="hs-identifier">sqCAI</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720323805708"><a href="CerkeFS.Internal.Board.html#sqMAI"><span class="hs-identifier">sqMAI</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720323805709"><a href="CerkeFS.Internal.Board.html#sqPAI"><span class="hs-identifier">sqPAI</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-244"></a><span> </span><a name="local-8214565720323805710"><a href="CerkeFS.Internal.Board.html#sqKAU"><span class="hs-identifier">sqKAU</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720323805711"><a href="CerkeFS.Internal.Board.html#sqLAU"><span class="hs-identifier">sqLAU</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720323805712"><a href="CerkeFS.Internal.Board.html#sqNAU"><span class="hs-identifier">sqNAU</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720323805713"><a href="CerkeFS.Internal.Board.html#sqTAU"><span class="hs-identifier">sqTAU</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720323805714"><a href="CerkeFS.Internal.Board.html#sqZAU"><span class="hs-identifier">sqZAU</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720323805715"><a href="CerkeFS.Internal.Board.html#sqXAU"><span class="hs-identifier">sqXAU</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720323805716"><a href="CerkeFS.Internal.Board.html#sqCAU"><span class="hs-identifier">sqCAU</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720323805717"><a href="CerkeFS.Internal.Board.html#sqMAU"><span class="hs-identifier">sqMAU</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720323805718"><a href="CerkeFS.Internal.Board.html#sqPAU"><span class="hs-identifier">sqPAU</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-245"></a><span> </span><a name="local-8214565720323805719"><a href="CerkeFS.Internal.Board.html#sqKIA"><span class="hs-identifier">sqKIA</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720323805720"><a href="CerkeFS.Internal.Board.html#sqLIA"><span class="hs-identifier">sqLIA</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720323805721"><a href="CerkeFS.Internal.Board.html#sqNIA"><span class="hs-identifier">sqNIA</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720323805722"><a href="CerkeFS.Internal.Board.html#sqTIA"><span class="hs-identifier">sqTIA</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720323805723"><a href="CerkeFS.Internal.Board.html#sqZIA"><span class="hs-identifier">sqZIA</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720323805724"><a href="CerkeFS.Internal.Board.html#sqXIA"><span class="hs-identifier">sqXIA</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720323805725"><a href="CerkeFS.Internal.Board.html#sqCIA"><span class="hs-identifier">sqCIA</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720323805726"><a href="CerkeFS.Internal.Board.html#sqMIA"><span class="hs-identifier">sqMIA</span></a></a><span class="hs-special">,</span><span> </span><a name="local-8214565720323805727"><a href="CerkeFS.Internal.Board.html#sqPIA"><span class="hs-identifier">sqPIA</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="CerkeFS.Internal.Board.html#sqList"><span class="hs-identifier hs-var">sqList</span></a><span>
</span><a name="line-246"></a><span>
</span><a name="line-247"></a><span class="hs-identifier">toSquare</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CerkeFS.Internal.Board_Internal.html#Square2"><span class="hs-identifier hs-type">Square2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Internal.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span>
</span><a name="line-248"></a><a name="toSquare"><a href="CerkeFS.Internal.Board.html#toSquare"><span class="hs-identifier">toSquare</span></a></a><span> </span><a name="local-6989586621679032669"><a href="#local-6989586621679032669"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CerkeFS.Internal.Board.html#sqList"><span class="hs-identifier hs-var">sqList</span></a><span> </span><span class="hs-operator hs-var">!!</span><span> </span><a href="#local-6989586621679032669"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-249"></a><span class="hs-comment">-- let (r,c) = i `divMod` 9 in (Square (toEnum r) (toEnum c)) was slightly slower</span><span>
</span><a name="line-250"></a><span>
</span><a name="line-251"></a><span class="hs-identifier">fromSquare</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CerkeFS.Internal.Board.html#Square"><span class="hs-identifier hs-type">Square</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Internal.Board_Internal.html#Square2"><span class="hs-identifier hs-type">Square2</span></a><span>
</span><a name="line-252"></a><a name="fromSquare"><a href="CerkeFS.Internal.Board.html#fromSquare"><span class="hs-identifier">fromSquare</span></a></a><span> </span><span class="hs-special">(</span><a href="CerkeFS.Internal.Board.html#Square"><span class="hs-identifier hs-var">Square</span></a><span> </span><a name="local-6989586621679032670"><a href="#local-6989586621679032670"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679032671"><a href="#local-6989586621679032671"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromEnum</span><span> </span><a href="#local-6989586621679032670"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-number">9</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier hs-var">fromEnum</span><span> </span><a href="#local-6989586621679032671"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-253"></a><span>
</span><a name="line-254"></a><span class="hs-identifier">fromBoard1_old</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="CerkeFS.Internal.Board.html#Board1_old"><span class="hs-identifier hs-type">Board1_old</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="CerkeFS.Internal.Board_Internal.html#Board1"><span class="hs-identifier hs-type">Board1</span></a><span>
</span><a name="line-255"></a><a name="fromBoard1_old"><a href="CerkeFS.Internal.Board.html#fromBoard1_old"><span class="hs-identifier">fromBoard1_old</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="CerkeFS.Internal.Board_Internal.html#Board1"><span class="hs-identifier hs-var">Board1</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">I</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromList</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679032672"><a href="#local-6989586621679032672"><span class="hs-identifier">s</span></a></a><span class="hs-special">,</span><a name="local-6989586621679032673"><a href="#local-6989586621679032673"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="CerkeFS.Internal.Board.html#fromSquare"><span class="hs-identifier hs-var">fromSquare</span></a><span> </span><a href="#local-6989586621679032672"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032673"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-256"></a></pre></body></html>